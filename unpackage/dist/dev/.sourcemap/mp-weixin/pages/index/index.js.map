{"version":3,"sources":["uni-app:///main.js","webpack:////Users/pengdx/YjzsSpace/WebSpance/nbAvatarTool/pages/index/index.vue?c451","webpack:////Users/pengdx/YjzsSpace/WebSpance/nbAvatarTool/pages/index/index.vue?2ade","webpack:////Users/pengdx/YjzsSpace/WebSpance/nbAvatarTool/pages/index/index.vue?e0e1","webpack:////Users/pengdx/YjzsSpace/WebSpance/nbAvatarTool/pages/index/index.vue?6668","uni-app:///pages/index/index.vue","webpack:////Users/pengdx/YjzsSpace/WebSpance/nbAvatarTool/pages/index/index.vue?7c07","webpack:////Users/pengdx/YjzsSpace/WebSpance/nbAvatarTool/pages/index/index.vue?4f28"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page"],"mappings":"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","file":"pages/index/index.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;import '@dcloudio/vue-cli-plugin-uni/packages/uni-cloud/dist/index.js';\nimport Vue from 'vue'\nimport Page from './pages/index/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=57280228&scoped=true&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=57280228&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"57280228\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/index/index.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=57280228&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"content\">\r\n\t\t<image src=\"/static/images/editor_bg.svg\" mode=\"widthFix\" class=\"all-back\"></image>\r\n\t\t\r\n\t\t<view class=\"top-content\">\r\n\t\t\t<scroll-view scroll-x :show-scrollbar=\"true\" class=\"scroll-view\">\r\n\t\t\t\t<view class=\"top-title\">\r\n\t\t\t\t\t<view class=\"title-unit\" :class=\"{ 'title-select': item.selected }\"\r\n\t\t\t\t\t\tv-for=\"(item, index) in categoriesList\" :key=\"item._id\" @click=\"switchCategory(item)\">\r\n\t\t\t\t\t\t{{ item.name }}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</scroll-view>\r\n\t\t\t<scroll-view scroll-x :show-scrollbar=\"true\" class=\"scroll-view\">\r\n\t\t\t\t<view class=\"image-div\">\r\n\t\t\t\t\t<view :class=\"{ 'image-margin': index !== 0 }\" v-for=\"(info, index) in imageList\" :key=\"info._id\"\r\n\t\t\t\t\t\t@click=\"imageClick(info)\">\r\n\t\t\t\t\t\t<image :src=\"info.image_url\"></image>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</scroll-view>\r\n\t\t</view>\r\n\r\n\t\t<view class=\"image-card\">\r\n\t\t\t<view class=\"photo-main-view\">\r\n\t\t\t\t<view class=\"avatar-div \" id=\"avatar-container\">\r\n\t\t\t\t\t<image class=\"img\" id=\"avatar-img\" :src=\"avatarImage\"></image>\r\n\t\t\t\t\t<view class=\"empty-view \" v-if=\"!avatarImage\">\r\n\t\t\t\t\t\t<image class=\"empty\" src=\"/static/images/empty.svg\">\r\n\t\t\t\t\t\t</image>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<image class=\"avatar-default \" :src=\"currentImage.image_url\"\r\n\t\t\t\t\t\tv-if=\"currentImage && currentImage.image_url\"></image>\r\n\t\t\t\t</view>\r\n\r\n\t\t\t\t<view class=\"ctlbtn\">\r\n\t\t\t\t\t<button class=\"action-btn btn-margin\" @click=\"getUserProfile('createImages')\">获取头像</button>\r\n\r\n\t\t\t\t\t<button class=\"action-btn btn-primary btn-margin\" @click=\"shareFc()\">保存头像</button>\r\n\t\t\t\t\t<button open-type=\"share\" class=\"action-btn share-btn\">发给朋友</button>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t\t<view style=\"margin: 20px;\">\r\n\t\t\t\t\t<ad unit-id=\"adunit-1b3406fe9b8e676a\" ad-type=\"video\" ad-theme=\"white\"></ad>\r\n\t\t\t\t</view>\r\n\r\n\r\n\t\t<view class=\"hideCanvasView\">\r\n\t\t\t<canvas class=\"hideCanvas\" id=\"default_PosterCanvasId\" canvas-id=\"default_PosterCanvasId\"\r\n\t\t\t\t:style=\"{ width: (poster.width || 10) + 'px', height: (poster.height || 10) + 'px' }\"></canvas>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport _app from '@/nxTemp/utils/qr/app.js';\r\n\timport {\r\n\t\tgetQr\r\n\t} from '@/nxTemp/utils/qr/qr.js';\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tposter: {},\r\n\t\t\t\tposterImage: '',\r\n\t\t\t\tcanvasId: 'default_PosterCanvasId',\r\n\t\t\t\tuserInfo: '',\r\n\t\t\t\tcode: '',\r\n\t\t\t\tavatarImage: uni.getStorageSync('avatar_image'),\r\n\t\t\t\tcurrentImage: {},\r\n\t\t\t\tcurrentIndex: 0,\r\n\t\t\t\timageList: [],\r\n\t\t\t\tcategoriesList: [],\r\n\t\t\t\tshareInfo: {\r\n\t\t\t\t\ttitle: \"庆国庆，换新颜，快来领取你的国庆头像吧\",\r\n\t\t\t\t\timageUrl: \"/static/images/share.png\",\r\n\t\t\t\t\tpath: \"pages/index/home\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t},\r\n\t\tonLoad() {\r\n\t\t\tthis.init();\r\n\t\t\tthis.getCategoriesList();\r\n\t\t\tuni.setStorageSync('shareInfo', this.shareInfo);\r\n\t\t},\r\n\t\tonShareAppMessage: function() {\r\n\t\t\treturn this.shareInfo;\r\n\t\t},\r\n\t\tonShareTimeline: function() {\r\n\t\t\treturn this.shareInfo;\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t/**\r\n\t\t\t * 获取分类\r\n\t\t\t */\r\n\t\t\tgetCategoriesList() {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '加载中',\r\n\t\t\t\t\tmask: true\r\n\t\t\t\t});\r\n\t\t\t\tuniCloud\r\n\t\t\t\t\t.callFunction({\r\n\t\t\t\t\t\tname: 'categories',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\ttype: 'mpweixin'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tthis.categoriesList = res.result.data;\r\n\t\t\t\t\t\tif (this.categoriesList.length > 0) {\r\n\t\t\t\t\t\t\tthis.$set(this.categoriesList[0], 'selected', true);\r\n\t\t\t\t\t\t\tthis.getImagesList(this.categoriesList[0]._id);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => {\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\tcontent: err.message || '请求服务失败',\r\n\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.finally(() => {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * @param {Object} id\r\n\t\t\t * 获取头像\r\n\t\t\t */\r\n\t\t\tgetImagesList(id, num) {\r\n\t\t\t\tuni.showLoading({\r\n\t\t\t\t\ttitle: '加载中',\r\n\t\t\t\t\tmask: true\r\n\t\t\t\t});\r\n\t\t\t\tuniCloud\r\n\t\t\t\t\t.callFunction({\r\n\t\t\t\t\t\tname: 'images_sourse',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\ttype: 'mpweixin',\r\n\t\t\t\t\t\t\tcategoryId: id\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tthis.imageList = res.result.data;\r\n\t\t\t\t\t\tif (this.imageList && this.imageList.length > 0) {\r\n\t\t\t\t\t\t\tif (num < 0) {\r\n\t\t\t\t\t\t\t\tthis.currentImage = this.imageList[this.imageList.length - 1];\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.currentImage = this.imageList[0];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(err => {\r\n\t\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\t\tcontent: err.message || '请求服务失败',\r\n\t\t\t\t\t\t\tshowCancel: false\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.finally(() => {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 初始化\r\n\t\t\t */\r\n\t\t\tasync init() {\r\n\t\t\t\tthis.userInfo = uni.getStorageSync('user_info');\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * @param {Object} item\r\n\t\t\t * 切换分类\r\n\t\t\t */\r\n\t\t\tswitchCategory(item, num) {\r\n\t\t\t\tlet info = this.categoriesList.filter(el => el.selected);\r\n\t\t\t\tif (info && info.length > 0) {\r\n\t\t\t\t\tinfo[0].selected = false;\r\n\t\t\t\t}\r\n\t\t\t\tthis.$set(item, 'selected', true);\r\n\t\t\t\tthis.getImagesList(item._id, num);\r\n\t\t\t},\r\n\r\n\t\t\t/**\r\n\t\t\t * @param {Object} item\r\n\t\t\t * 图片点击事件\r\n\t\t\t */\r\n\t\t\timageClick(item) {\r\n\t\t\t\tthis.currentImage = item;\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 获取微信code\r\n\t\t\t */\r\n\t\t\tgetWeixinCode() {\r\n\t\t\t\treturn new Promise((resolve, reject) => {\r\n\t\t\t\t\tuni.login({\r\n\t\t\t\t\t\tprovider: 'weixin',\r\n\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\tresolve(res.code);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail(err) {\r\n\t\t\t\t\t\t\treject(new Error('微信登录失败'));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 生成新头像\r\n\t\t\t */\r\n\t\t\tasync shareFc() {\r\n\t\t\t\tif (!this.avatarImage) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '请先获取头像',\r\n\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\ttry {\r\n\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\ttitle: '加载中',\r\n\t\t\t\t\t\tmask: true\r\n\t\t\t\t\t});\r\n\t\t\t\t\t_app.log('准备生成:' + new Date());\r\n\t\t\t\t\tconst d = await getQr({\r\n\t\t\t\t\t\t_this: this, //若在组件中使用 必传\r\n\t\t\t\t\t\ttype: 'testShareType',\r\n\t\t\t\t\t\tformData: {\r\n\t\t\t\t\t\t\t//访问接口获取背景图携带自定义数据\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tbackgroundImage: this.avatarImage,\r\n\t\t\t\t\t\tposterCanvasId: this.canvasId, //canvasId\r\n\t\t\t\t\t\tdelayTimeScale: 20, //延时系数\r\n\t\t\t\t\t\tdrawArray: ({\r\n\t\t\t\t\t\t\tbgObj,\r\n\t\t\t\t\t\t\ttype,\r\n\t\t\t\t\t\t\tbgScale\r\n\t\t\t\t\t\t}) => {\r\n\t\t\t\t\t\t\t//可直接return数组，也可以return一个promise对象, 但最终resolve一个数组, 这样就可以方便实现后台可控绘制海报\r\n\t\t\t\t\t\t\treturn new Promise((rs, rj) => {\r\n\t\t\t\t\t\t\t\trs([{\r\n\t\t\t\t\t\t\t\t\ttype: 'image',\r\n\t\t\t\t\t\t\t\t\turl: this.currentImage.image_url,\r\n\t\t\t\t\t\t\t\t\tdx: 0,\r\n\t\t\t\t\t\t\t\t\tdy: 0,\r\n\t\t\t\t\t\t\t\t\tinfoCallBack(imageInfo) {\r\n\t\t\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t\t\tdWidth: bgObj.width, // 因为设置了圆形图片 所以要乘以2\r\n\t\t\t\t\t\t\t\t\t\t\tdHeight: bgObj.height\r\n\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}]);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsetCanvasWH: ({\r\n\t\t\t\t\t\t\tbgObj,\r\n\t\t\t\t\t\t\ttype,\r\n\t\t\t\t\t\t\tbgScale\r\n\t\t\t\t\t\t}) => {\r\n\t\t\t\t\t\t\t// 为动态设置画布宽高的方法，\r\n\t\t\t\t\t\t\tthis.poster = bgObj;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t_app.log('海报生成成功, 时间:' + new Date() + '， 临时路径: ' + d.poster.tempFilePath);\r\n\t\t\t\t\tthis.posterImage = d.poster.tempFilePath;\r\n\t\t\t\t\tthis.savefile();\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t_app.hideLoading();\r\n\t\t\t\t\t_app.showToast(JSON.stringify(e));\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 保存图片\r\n\t\t\t */\r\n\t\t\tsavefile() {\r\n\t\t\t\t//获取相册授权\r\n\t\t\t\tlet _self = this;\r\n\t\t\t\tuni.getSetting({\r\n\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\tif (!res.authSetting['scope.writePhotosAlbum']) {\r\n\t\t\t\t\t\t\tuni.authorize({\r\n\t\t\t\t\t\t\t\tscope: 'scope.writePhotosAlbum',\r\n\t\t\t\t\t\t\t\tsuccess() {\r\n\t\t\t\t\t\t\t\t\t//这里是用户同意授权后的回调\r\n\t\t\t\t\t\t\t\t\t_self.saveImgToLocal();\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\tfail(e) {\r\n\t\t\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t\t\t\twx.showModal({\r\n\t\t\t\t\t\t\t\t\t\tcontent: '检测到您没打开下载图片功能权限，是否去设置打开？',\r\n\t\t\t\t\t\t\t\t\t\tconfirmText: '确认',\r\n\t\t\t\t\t\t\t\t\t\tcancelText: '取消',\r\n\t\t\t\t\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\t\t\t\t\t//点击“确认”时打开设置页面\r\n\t\t\t\t\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\t\t\t\t\twx.openSetting();\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t//用户已经授权过了\r\n\t\t\t\t\t\t\t_self.saveImgToLocal();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * @param {Object} e\r\n\t\t\t * 保存到相册\r\n\t\t\t */\r\n\t\t\tsaveImgToLocal(e) {\r\n\t\t\t\tlet _self = this;\r\n\t\t\t\tuni.saveImageToPhotosAlbum({\r\n\t\t\t\t\tfilePath: _self.posterImage,\r\n\t\t\t\t\tsuccess: function() {\r\n\t\t\t\t\t\t_self.saveImageInfo();\r\n\t\t\t\t\t\tuni.setStorageSync('currentImage', _self.posterImage);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: function() {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ttitle: '保存失败',\r\n\t\t\t\t\t\t\ticon: 'none'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * 头像\r\n\t\t\t */\r\n\t\t\tsaveImageInfo() {\r\n\t\t\t\tuniCloud\r\n\t\t\t\t\t.callFunction({\r\n\t\t\t\t\t\tname: 'images_sourse',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\timageInfo: this.currentImage,\r\n\t\t\t\t\t\t\ttype: 'imageUsed'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t\turl: '/pages/index/save-success'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * @param {Object} type\r\n\t\t\t * 获取头像\r\n\t\t\t */\r\n\t\t\tasync getUserProfile(type) {\r\n\t\t\t\tlet _this = this;\r\n\t\t\t\tuni.getUserProfile({\r\n\t\t\t\t\tdesc: '获取您的头像信息',\r\n\t\t\t\t\tsuccess(result) {\r\n\t\t\t\t\t\tlet data = {\r\n\t\t\t\t\t\t\tcode: _this.code,\r\n\t\t\t\t\t\t\tsignature: result.signature,\r\n\t\t\t\t\t\t\tencrypted_data: result.encryptedData,\r\n\t\t\t\t\t\t\tiv: result.iv,\r\n\t\t\t\t\t\t\tuserInfo: result.userInfo\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tlet info = data.userInfo.avatarUrl;\r\n\t\t\t\t\t\tif (type === 'createImages') {\r\n\t\t\t\t\t\t\t_this.avatarImage = info.substring(0, info.lastIndexOf('/') + 1) + '0';\r\n\t\t\t\t\t\t\tuni.setStorageSync('avatar_image', _this.avatarImage);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t_this.postUserInfo(result.userInfo.nickName, type);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail(fall) {}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t/**\r\n\t\t\t * @param {Object} nickName\r\n\t\t\t * 存储用户数据\r\n\t\t\t */\r\n\t\t\tasync postUserInfo(nickName, type) {\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tthis.code = await this.getWeixinCode();\r\n\t\t\t\tif (type === 'userLogin') {\r\n\t\t\t\t\tuni.showLoading({\r\n\t\t\t\t\t\ttitle: '加载中',\r\n\t\t\t\t\t\tmask: true\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tuniCloud\r\n\t\t\t\t\t.callFunction({\r\n\t\t\t\t\t\tname: 'user_mpweixin',\r\n\t\t\t\t\t\tdata: {\r\n\t\t\t\t\t\t\tcode: that.code,\r\n\t\t\t\t\t\t\tavatarImage: that.avatarImage,\r\n\t\t\t\t\t\t\tnickName,\r\n\t\t\t\t\t\t\ttype\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tuni.setStorageSync('user_info', res.result);\r\n\t\t\t\t\t\tthis.userInfo = res.result;\r\n\t\t\t\t\t\tif (type === 'userLogin') {\r\n\t\t\t\t\t\t\tuni.hideLoading();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.content {\r\n\t\tbackground-size: 100% 100%;\r\n\t\tpadding-top: 300rpx;\r\n\r\n\t\t.all-back {\r\n\t\t\tposition: fixed;\r\n\t\t\ttop: 0;\r\n\t\t\tleft: 0;\r\n\t\t\tright: 0;\r\n\t\t\tbottom: 0;\r\n\t\t\tmin-height: 100vh;\r\n\t\t\twidth: 750rpx;\r\n\t\t}\r\n\r\n\t\t.top-content {\r\n\t\t\tbackground-color: #ffffff;\r\n\t\t\tmargin: 30rpx;\r\n\t\t\tborder-radius: 50rpx;\r\n\t\t\tpadding: 0 40rpx 30rpx;\r\n\t\t\tposition: relative;\r\n\r\n\t\t\t.top-title {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\r\n\t\t\t\t.title-unit {\r\n\t\t\t\t\tpadding: 40rpx 20rpx;\r\n\t\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\t\tflex-shrink: 0;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.title-select {\r\n\t\t\t\t\tfont-size: 30rpx;\r\n\t\t\t\t\tfont-weight: bold;\r\n\t\t\t\t\tcolor: #ff4500;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.image-div {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tpadding-left: 20rpx;\r\n\t\t\t\tpadding-bottom: 20rpx;\r\n\t\t\t\tbackground-color: #ffffff;\r\n\r\n\t\t\t\timage {\r\n\t\t\t\t\twidth: 120rpx;\r\n\t\t\t\t\theight: 120rpx;\r\n\t\t\t\t\tborder: 1rpx solid #f8f8f8;\r\n\t\t\t\t\tbox-shadow: 0px -5px 15px 0px rgba(224, 224, 224, 0.4);\r\n\t\t\t\t\tflex-shrink: 0;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.image-margin {\r\n\t\t\t\t\tmargin: 0 20rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.image-card {\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: center;\r\n\t\t\talign-items: center;\r\n\t\t\tposition: relative;\r\n\r\n\t\t}\r\n\t}\r\n\r\n\t.title {\r\n\t\tfont-size: 36rpx;\r\n\t\tcolor: #8f8f94;\r\n\t}\r\n\r\n\t.avatar-div {\r\n\t\theight: 380rpx;\r\n\t\tmargin-right: 40rpx;\r\n\t\tposition: relative;\r\n\t\twidth: 380rpx;\r\n\t}\r\n\r\n\t.avatar-div,\r\n\t.empty-view {\r\n\t\t-webkit-box-orient: vertical;\r\n\t\t-webkit-box-direction: normal;\r\n\t\t-webkit-box-pack: center;\r\n\t\t-webkit-box-align: center;\r\n\t\talign-items: center;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tjustify-content: center;\r\n\t\tz-index: 1;\r\n\t}\r\n\r\n\t.empty {\r\n\t\theight: 100px;\r\n\t\tmargin-bottom: 24px;\r\n\t\twidth: 100px;\r\n\t}\r\n\r\n\t.img {\r\n\t\tbackground-color: #fff;\r\n\t\tborder-radius: 48rpx;\r\n\t\theight: 360rpx;\r\n\t\tposition: absolute;\r\n\t\twidth: 360rpx;\r\n\t\tz-index: 0;\r\n\t}\r\n\r\n\t.avatar-default {\r\n\t\tborder-radius: 48rpx;\r\n\t\theight: 100%;\r\n\t\tleft: 0;\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\twidth: 100%;\r\n\t\tz-index: 10;\r\n\t}\r\n\r\n\t.container {\r\n\t\tbackground-color: #fbebe1;\r\n\t\tmin-height: 100vh;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.photo-main-view {\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\twidth: 690rpx;\r\n\t\tmargin: 30rpx 30rpx 0;\r\n\t}\r\n\r\n\r\n\t.action-btn {\r\n\t\tbackground: #fff;\r\n\t\tborder: 1rpx solid #efefef;\r\n\t\tborder-radius: 48rpx;\r\n\t\tbox-shadow: 0 12rpx 16rpx -8rpx rgba(0, 0, 0, 0.1);\r\n\t\tcolor: #4d4d4d;\r\n\t\tfont-weight: bolder;\r\n\t\theight: 90rpx;\r\n\t\tline-height: 90rpx;\r\n\t\tfont-size: 30rpx;\r\n\t\tpadding: 0 60rpx;\r\n\t}\r\n\r\n\t.btn-margin {\r\n\t\tmargin-bottom: 50rpx;\r\n\t}\r\n\r\n\t.btn-primary {\r\n\t\tbackground: linear-gradient(97.71deg, #ffa462, #ff4d42 88.36%);\r\n\t\tborder: 1rpx solid #ff7852;\r\n\t\tborder-radius: 48rpx;\r\n\t\tbox-shadow: 0 12rpx 16rpx -8rpx rgba(255, 88, 35, 0.6);\r\n\t\tcolor: #fff;\r\n\t}\r\n\r\n\t.share-btn {\r\n\t\tdisplay: inline-block;\r\n\t\tbackground: linear-gradient(97.71deg, #ffd01e, #ff8917 60%);\r\n\t\tborder: 1rpx solid #ff7852;\r\n\t\tborder-radius: 48rpx;\r\n\t\tbox-shadow: 0 12rpx 16rpx -8rpx rgba(255, 88, 35, 0.6);\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 30rpx;\r\n\t\theight: 90rpx;\r\n\t\tline-height: 90rpx;\r\n\t}\r\n\r\n\r\n\t.hideCanvasView {\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t.hideCanvas {\r\n\t\tposition: fixed;\r\n\t\ttop: -99999upx;\r\n\t\tleft: -99999upx;\r\n\t\tz-index: -99999;\r\n\t}\r\n</style>\n","import mod from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=57280228&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&id=57280228&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1667790926706\n      var cssReload = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}